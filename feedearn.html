<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>ğŸ¾ Pet Feeder Control</title>
  <script src="https://unpkg.com/mqtt/dist/mqtt.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      background: #f4f6f8;
      margin-top: 80px;
    }
    h1 { color: #4caf50; }
    button {
      background: #4caf50;
      color: white;
      padding: 14px 28px;
      font-size: 18px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }
    button:hover { background: #43a047; }
    #status { font-weight: bold; color: #333; }
  </style>
</head>
<body>
  <h1>ğŸ± Pet Feeder Control</h1>
  <button id="feedBtn">Feed Now</button>
  <p>Status: <span id="status">Connecting...</span></p>

  
  <script>
    //HiveMQ Cloud
    const broker = "wss://0b6280fa49a549c58dab95e2bb422274.s1.eu.hivemq.cloud:8884/mqtt";
    const options = {
      username: "petfeederpromax",
      password: "Password12345",
      clientId: "web-" + Math.random().toString(16).substr(2, 8)
    };

    const client = mqtt.connect(broker, options);
    const feedBtn = document.getElementById("feedBtn");
    const statusEl = document.getElementById("status");

    client.on("connect", () => {
      console.log("Connected to HiveMQ");
      statusEl.textContent = "ğŸŸ¢ Connected";
      client.subscribe("petfeeder/status");
    });

    client.on("message", (topic, message) => {
      if (topic === "petfeeder/status") {
        statusEl.textContent = message.toString();
      }
    });

    feedBtn.addEventListener("click", () => {
      client.publish("petfeeder/cmd", "feed");
      statusEl.textContent = "Feeding...";
    });

    client.on("error", (err) => {
      console.error("MQTT Error:", err);
      statusEl.textContent = "ğŸ”´ Connection Error";
    });
  </script>
</body>
</html>